!function(){"use strict";function a(a,b,c,d){this.instanceId=a,this.flashObject=b,c=c||{},c.error=this.proxyError.bind(this),this.pubnub=c&&d?f().secure(c):c?f().init(c):f()}function b(){this.delegateAsync(g().async_methods_to_delegate),this.delegateSync(g().sync_methods_to_delegate),this.flashObject=null,this.flashObjectId="pubnubFlashObject",this.instances={}}function c(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(a[c]);return b}function d(a){return"isArray"in Array?Array.isArray(a):"[object Array]"==Object.prototype.toString.call(a)}function e(a){return"string"==typeof a}function f(){if("undefined"==typeof PUBNUB)throw Error("pubnub.js lib should be included before actionscript proxy lib");return PUBNUB}var g=function(){return{callback_fields:{leave:["callback","error"],history:["callback","error"],replay:["callback"],publish:["callback","error"],unsubscribe:["callback","error"],subscribe:["callback","message","connect","reconnect","disconnect","error","idle","presence"],here_now:["callback","error","data"],grant:["callback","error"],revoke:["callback","error"],audit:["callback","error"],where_now:["callback","error"],state:["callback","error"],channel_group:["callback","error"],channel_group_list_channels:["callback","error"],channel_group_list_groups:["callback","error"],channel_group_list_namespaces:["callback","error"],channel_group_remove_channel:["callback","error"],channel_group_remove_group:["callback","error"],channel_group_remove_namespace:["callback","error"],channel_group_add_channel:["callback","error"],channel_group_cloak:["callback","error"]},methods_with_callback_in_args:["history","time","publish","unsubscribe","subscribe","here_now","grant","audit","revoke","time","where_now","state","channel_group","channel_group_list_channels","channel_group_list_groups","channel_group_list_namespaces","channel_group_remove_channel","channel_group_remove_group","channel_group_remove_namespace","channel_group_add_channel","channel_group_cloak"],async_methods_to_delegate:["history","replay","subscribe","publish","unsubscribe","here_now","grant","revoke","audit","time","where_now","state","channel_group","channel_group_list_channels","channel_group_list_groups","channel_group_list_namespaces","channel_group_remove_channel","channel_group_remove_group","channel_group_remove_namespace","channel_group_add_channel","channel_group_cloak"],sync_methods_to_delegate:["set_uuid","get_uuid","uuid","auth","set_cipher_key","get_cipher_key","raw_encrypt","raw_decrypt","set_heartbeat","get_heartbeat","set_heartbeat_interval","get_heartbeat_interval"]}};a.prototype.applyCallback=function(a,b){b=btoa(JSON.stringify(b)),this.flashObject.callback(this.instanceId,a,b)},a.prototype.applyMethod=function(a,b){if(!(g().async_methods_to_delegate.indexOf(a)<0)){var c,d;for(d=0,c=b.length;c>d;d++)g().methods_with_callback_in_args.indexOf(a)>=0&&d===c-1&&"string"==typeof b[d]?b[d]=this.mockCallback(b[d]):"object"==typeof b[d]&&this.mockObjectCallbacks(b[d],g().callback_fields[a]);this.pubnub[a].apply(this.pubnub,b)}},a.prototype.mockCallback=function(a){var b=this;return function(){b.applyCallback(a,c(arguments))}},a.prototype.mockObjectCallbacks=function(a,b){if(b)for(var c in a)a.hasOwnProperty(c)&&b.indexOf(c)>=0&&(a[c]=this.mockCallback(a[c]))},a.prototype.proxyError=function(a){this.flashObject.instanceError(this.instanceId,a)},b.prototype.setFlashObjectId=function(a){if(!e(a))throw new TypeError("flashObjectId argument should be a string");this.flashObjectId=a},b.prototype.getFlashObject=function(){return null===this.flashObject&&(this.flashObject=document.getElementById(this.flashObjectId)),this.flashObject},b.prototype.delegateAsync=function(a){if(!d(a))throw new TypeError("delegate method accepts only methods array");var b,c=this,e=a.length;for(b=0;e>b;b++)this[a[b]]=function(a){return function(b,d){c.delegatedMethod.call(c,b,a,d)}}(a[b])},b.prototype.delegateSync=function(a){if(!d(a))throw new TypeError("delegateSynchronous method accepts only methods array");var b,c=this,e=a.length;for(b=0;e>b;b++)this[a[b]]=function(a){return function(b,d){var e=c.getInstance(b).pubnub;return e[a].apply(e,d)}}(a[b])},b.prototype.delegatedMethod=function(a,b,c){this.getInstance(a).applyMethod(b,c)},b.prototype.createInstance=function(b,c,d){if(!e(b))throw new TypeError("instanceId argument should be a string");b in this.instances&&this.proxyError("instance with id "+b+" already exists");var f=this.getFlashObject();this.instances[b]=new a(b,f,c,d),f.created(b)},b.prototype.getInstance=function(a){return a in this.instances||this.proxyError("instance with id "+a+" is not present"),this.instances[a]},b.prototype.proxyError=function(a){this.getFlashObject().error(a)},window.btoa||(window.btoa=function(a){var b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",c="",d=0;do{var e=a.charCodeAt(d++),f=a.charCodeAt(d++),g=a.charCodeAt(d++);e=e?e:0,f=f?f:0,g=g?g:0;var h=e>>2&63,i=(3&e)<<4|f>>4&15,j=(15&f)<<2|g>>6&3,k=63&g;f?g||(k=64):j=k=64,c+=b.charAt(h)+b.charAt(i)+b.charAt(j)+b.charAt(k)}while(d<a.length);return c}),window.PUBNUB_AS2JS_PROXY=new b}(this);